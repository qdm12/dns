package provider

import "net/netip"

func Cloudflare() Provider {
	return Provider{
		Name: "Cloudflare",
		DNS: DNSServer{
			IPv4: []netip.AddrPort{
				defaultDNSIPv4AddrPort([4]byte{1, 1, 1, 1}),
				defaultDNSIPv4AddrPort([4]byte{1, 0, 0, 1}),
			},
			IPv6: []netip.AddrPort{
				defaultDNSIPv6AddrPort([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11, 0x11}),
				defaultDNSIPv6AddrPort([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x01}),
			},
		},
		DoT: DoTServer{
			IPv4: []netip.AddrPort{
				// Note: these are the two only IPv4 addresses working with DNS over TLS
				defaultDoTIPv4AddrPort([4]byte{1, 1, 1, 1}),
				defaultDoTIPv4AddrPort([4]byte{1, 0, 0, 1}),
			},
			IPv6: []netip.AddrPort{
				// Note: these are the two only IPv6 addresses working with DNS over TLS
				defaultDoTIPv6AddrPort([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11, 0x11}),
				defaultDoTIPv6AddrPort([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x01}),
			},
			Name: "cloudflare-dns.com",
		},
		DoH: DoHServer{
			URL: "https://cloudflare-dns.com/dns-query",
			IPv4: []netip.Addr{
				// Note: these 4 IPv4 addresses are all working with DNS over HTTPS,
				// but not all work with DNS over TLS
				netip.AddrFrom4([4]byte{1, 1, 1, 1}),
				netip.AddrFrom4([4]byte{1, 0, 0, 1}),
				netip.AddrFrom4([4]byte{104, 16, 249, 249}),
				netip.AddrFrom4([4]byte{104, 16, 248, 249}),
			},
			IPv6: []netip.Addr{
				// Note: these 4 IPv6 addresses are all working with DNS over HTTPS,
				// but not all work with DNS over TLS
				netip.AddrFrom16([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11, 0x11}),
				netip.AddrFrom16([16]byte{0x26, 0x6, 0x47, 0x0, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x10, 0x01}),
				netip.AddrFrom16([16]byte{0x26, 0x6, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x68, 0x10, 0xf9, 0xfc}),
				netip.AddrFrom16([16]byte{0x26, 0x6, 0x47, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x68, 0x10, 0xf8, 0xf9}),
			},
		},
	}
}
